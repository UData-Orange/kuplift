# Copyright (c) 2026 Orange. All rights reserved.
# This software is distributed under the MIT License, the text of which is available
# at https://spdx.org/licenses/MIT.html or see the "LICENSE" file for more details.

import re
from math import inf
import pytest
import pandas as pd
from kuplift import OptimizedUnivariateEncoding
from kuplift.optimized_univariate_encoding import TargetTreatmentPair as TT, ValGrpPartition, ValGrp, IntervalPartition, Interval

def test_input_variables(opt_ue_with_catvar):
    assert opt_ue_with_catvar.input_variables == ["VAR1", "VAR2", "VAR3", "VAR4"]
    assert opt_ue_with_catvar.informative_input_variables == ["VAR1", "VAR2", "VAR3"]
    assert opt_ue_with_catvar.noninformative_input_variables == ["VAR4"]

def test_treatment_name(opt_ue_with_catvar):
    assert opt_ue_with_catvar.treatment_name == "TRAITEMENT"

def test_target_name(opt_ue_with_catvar):
    assert opt_ue_with_catvar.target_name == "CIBLE"

def test_treatment_modalities(opt_ue_with_catvar):
    assert set(opt_ue_with_catvar.treatment_modalities) == {"T0", "T1"}

def test_target_modalities(opt_ue_with_catvar):
    assert set(opt_ue_with_catvar.target_modalities) == {0, 1}

def test_target_treatment_pairs(opt_ue_with_catvar):
    assert set(opt_ue_with_catvar.target_treatment_pairs) == {TT(0, "T0"), TT(1, "T0"), TT(0, "T1"), TT(1, "T1")}

def test_get_levels(opt_ue_with_catvar):
    assert opt_ue_with_catvar.get_levels() == [("VAR2", 0.973101), ("VAR1", 0.883716), ("VAR3", 0.881227), ("VAR4", 0)]

def test_get_level(opt_ue_with_catvar):
    assert opt_ue_with_catvar.get_level("VAR1") == 0.883716
    assert opt_ue_with_catvar.get_level("VAR2") == 0.973101
    assert opt_ue_with_catvar.get_level("VAR3") == 0.881227
    assert opt_ue_with_catvar.get_level("VAR4") == 0

def test_get_partition(opt_ue_with_catvar):
    assert opt_ue_with_catvar.get_partition("VAR1") == IntervalPartition([Interval(lower=None, upper=None),
                                                                          Interval(lower=-inf, upper=2.0004),
                                                                          Interval(lower=2.0004, upper=3.00025),
                                                                          Interval(lower=3.00025, upper=4),
                                                                          Interval(lower=4, upper=4.9983),
                                                                          Interval(lower=4.9983, upper=5.991),
                                                                          Interval(lower=5.991, upper=7.0002),
                                                                          Interval(lower=7.0002, upper=8.0009),
                                                                          Interval(lower=8.0009, upper=9),
                                                                          Interval(lower=9, upper=inf)])
    assert opt_ue_with_catvar.get_partition("VAR2") == ValGrpPartition([ValGrp(['8', '6', '0', '4', '2']),
                                                                        ValGrp(['3', '7', '1', '5', '9'])],
                                                                        1)
    assert opt_ue_with_catvar.get_partition("VAR3") == IntervalPartition([Interval(lower=-inf, upper=12.004),
                                                                          Interval(lower=12.004, upper=14.0009),
                                                                          Interval(lower=14.0009, upper=16.0005),
                                                                          Interval(lower=16.0005, upper=18),
                                                                          Interval(lower=18, upper=19.99999),
                                                                          Interval(lower=19.99999, upper=21.983),
                                                                          Interval(lower=21.983, upper=24.0004),
                                                                          Interval(lower=24.0004, upper=25.9957),
                                                                          Interval(lower=25.9957, upper=28),
                                                                          Interval(lower=28, upper=inf)])

def test_get_target_frequencies(opt_ue_with_catvar):
    assert repr(opt_ue_with_catvar.get_target_frequencies("VAR1")) == """
                Part  (1|T1)  (1|T0)  (0|T1)  (0|T0)
0                 []     110       0       0     100
1     [-inf, 2.0004[       0      92     100       0
2  [2.0004, 3.00025[      95       0       0      97
3       [3.00025, 4[       0     108     107       0
4        [4, 4.9983[      97       0       0     106
5    [4.9983, 5.991[       0      93      97       1
6    [5.991, 7.0002[     106       0       0     113
7   [7.0002, 8.0009[       1      91     103       0
8        [8.0009, 9[     101       0       0     118
9           [9, inf[       0      81      83       0"""[1:]

def test_get_target_probabilities(opt_ue_with_catvar):
    assert repr(opt_ue_with_catvar.get_target_probabilities("VAR1")) == """
                Part    (1|T1)    (1|T0)    (0|T1)    (0|T0)
0                 []  1.000000  0.000000  0.000000  1.000000
1     [-inf, 2.0004[  0.000000  1.000000  1.000000  0.000000
2  [2.0004, 3.00025[  1.000000  0.000000  0.000000  1.000000
3       [3.00025, 4[  0.000000  1.000000  1.000000  0.000000
4        [4, 4.9983[  1.000000  0.000000  0.000000  1.000000
5    [4.9983, 5.991[  0.000000  0.989362  1.000000  0.010638
6    [5.991, 7.0002[  1.000000  0.000000  0.000000  1.000000
7   [7.0002, 8.0009[  0.009615  1.000000  0.990385  0.000000
8        [8.0009, 9[  1.000000  0.000000  0.000000  1.000000
9           [9, inf[  0.000000  1.000000  1.000000  0.000000"""[1:]

def test_get_uplift(opt_ue_with_catvar):
    assert repr(opt_ue_with_catvar.get_uplift(1, "T0", "VAR1")) == """
                Part  Uplift 1 T1
0                 []     1.000000
1     [-inf, 2.0004[    -1.000000
2  [2.0004, 3.00025[     1.000000
3       [3.00025, 4[    -1.000000
4        [4, 4.9983[     1.000000
5    [4.9983, 5.991[    -0.989362
6    [5.991, 7.0002[     1.000000
7   [7.0002, 8.0009[    -0.990385
8        [8.0009, 9[     1.000000
9           [9, inf[    -1.000000"""[1:]

def test_fit_transform(df_with_catvar):
    test_dataframe = df_with_catvar
    test_dataframe = test_dataframe.astype({"VAR2": object})
    input_variables = list(test_dataframe.columns[:-2])
    ue = OptimizedUnivariateEncoding()
    with pytest.warns(UserWarning, match=f"""^{re.escape("Target column's dtype is not object; fixing...")}$"""):
        assert ue.fit_transform(test_dataframe[input_variables], test_dataframe["TRAITEMENT"], test_dataframe["CIBLE"]).to_string() == """
      VAR2  VAR1  VAR3
0        0     0     0
1        0     0     0
2        0     0     0
3        1     7     7
4        0     6     6
5        1     7     7
6        1     9     9
7        0     6     6
8        0     0     0
9        0     0     0
10       1     1     1
11       0     4     4
12       0     4     4
13       0     2     2
14       1     3     3
15       1     7     7
16       0     0     0
17       0     8     8
18       0     4     4
19       0     8     8
20       0     2     2
21       1     5     5
22       1     7     7
23       0     8     8
24       0     2     2
25       0     8     8
26       1     9     9
27       1     7     7
28       0     0     0
29       0     6     6
30       1     9     9
31       1     3     3
32       1     1     1
33       1     1     1
34       0     4     4
35       1     3     3
36       0     4     4
37       1     1     1
38       0     8     8
39       0     2     2
40       1     1     1
41       0     4     4
42       1     5     5
43       0     6     6
44       1     3     3
45       0     6     6
46       0     6     6
47       0     2     2
48       1     5     5
49       0     0     0
50       1     9     9
51       1     5     5
52       1     9     9
53       0     6     6
54       0     8     8
55       0     6     6
56       0     2     2
57       0     4     4
58       0     8     8
59       1     7     7
60       0     0     0
61       1     9     9
62       0     4     4
63       1     7     7
64       0     0     0
65       0     4     4
66       1     7     7
67       0     2     2
68       1     7     7
69       1     3     3
70       0     0     0
71       0     6     6
72       1     1     1
73       1     9     9
74       1     7     7
75       1     9     9
76       0     4     4
77       0     2     2
78       0     0     0
79       1     9     9
80       0     6     6
81       0     8     8
82       1     7     7
83       1     7     7
84       0     2     2
85       1     3     3
86       1     7     7
87       0     4     4
88       0     8     8
89       1     3     3
90       0     6     6
91       1     9     9
92       0     0     0
93       0     8     8
94       0     4     4
95       1     7     7
96       1     3     3
97       1     7     7
98       0     8     8
99       1     5     5
100      0     6     6
101      1     1     1
102      0     2     2
103      1     5     5
104      0     8     8
105      1     3     3
106      0     2     2
107      0     4     4
108      1     9     9
109      1     5     5
110      1     7     7
111      1     5     5
112      0     2     2
113      1     7     7
114      0     4     4
115      1     7     7
116      1     5     5
117      0     2     2
118      1     7     7
119      1     7     7
120      1     3     3
121      1     5     5
122      1     3     3
123      0     0     0
124      0     4     4
125      1     7     7
126      1     1     1
127      1     1     1
128      1     1     1
129      1     3     3
130      0     4     4
131      0     0     0
132      1     3     3
133      1     5     5
134      0     0     0
135      0     6     6
136      0     2     2
137      1     9     9
138      1     7     7
139      1     3     3
140      0     2     2
141      1     5     5
142      1     1     1
143      0     6     6
144      1     1     1
145      0     2     2
146      0     4     4
147      1     3     3
148      0     6     6
149      0     0     0
150      1     9     9
151      1     7     7
152      0     8     8
153      0     0     0
154      0     2     2
155      0     8     8
156      0     4     4
157      0     4     4
158      1     3     3
159      1     1     1
160      1     7     7
161      1     1     1
162      1     7     7
163      0     6     6
164      1     9     9
165      1     3     3
166      1     1     1
167      1     9     9
168      1     9     9
169      1     5     5
170      0     8     8
171      0     6     6
172      0     6     6
173      1     1     1
174      1     3     3
175      1     1     1
176      1     7     7
177      0     0     0
178      0     4     4
179      1     3     3
180      0     0     0
181      0     2     2
182      1     1     1
183      0     2     2
184      0     4     4
185      0     4     4
186      0     0     0
187      1     1     1
188      1     5     5
189      1     1     1
190      1     5     5
191      0     2     2
192      0     2     2
193      0     6     6
194      1     9     9
195      0     6     6
196      1     5     5
197      0     6     6
198      1     1     1
199      0     0     0
200      1     1     1
201      1     9     9
202      1     5     5
203      0     0     0
204      0     2     2
205      0     2     2
206      1     1     1
207      1     5     5
208      1     5     5
209      1     5     5
210      1     9     9
211      0     0     0
212      0     4     4
213      0     8     8
214      0     4     4
215      0     4     4
216      1     1     1
217      0     2     2
218      0     8     8
219      0     4     4
220      1     1     1
221      0     0     0
222      0     8     8
223      0     2     2
224      1     7     7
225      0     8     8
226      1     3     3
227      1     1     1
228      0     2     2
229      1     5     5
230      1     5     5
231      0     4     4
232      1     3     3
233      0     8     8
234      0     2     2
235      0     2     2
236      0     4     4
237      1     7     7
238      1     5     5
239      0     6     6
240      0     4     4
241      1     9     9
242      0     6     6
243      1     7     7
244      0     8     8
245      1     3     3
246      1     5     5
247      1     9     9
248      1     3     3
249      0     8     8
250      1     3     3
251      0     6     6
252      1     5     5
253      1     9     9
254      1     7     7
255      0     8     8
256      0     2     2
257      1     9     9
258      0     0     0
259      0     8     8
260      0     8     8
261      0     6     6
262      1     3     3
263      0     0     0
264      0     6     6
265      1     1     1
266      1     1     1
267      0     2     2
268      1     3     3
269      0     2     2
270      0     0     0
271      1     7     7
272      0     4     4
273      1     1     1
274      0     8     8
275      0     0     0
276      1     3     3
277      1     7     7
278      1     5     5
279      0     6     6
280      1     3     3
281      1     1     1
282      1     3     3
283      0     6     6
284      0     6     6
285      0     2     2
286      0     0     0
287      1     3     3
288      0     8     8
289      1     9     9
290      1     3     3
291      1     9     9
292      1     3     3
293      0     0     0
294      0     4     4
295      0     6     6
296      0     8     8
297      0     2     2
298      0     0     0
299      1     9     9
300      0     0     0
301      0     2     2
302      1     5     5
303      1     3     3
304      0     4     4
305      0     0     0
306      0     4     4
307      1     5     5
308      0     8     8
309      0     6     6
310      1     3     3
311      1     7     7
312      1     3     3
313      1     1     1
314      0     4     4
315      1     3     3
316      0     8     8
317      1     3     3
318      0     0     0
319      1     9     9
320      1     5     5
321      0     0     0
322      1     1     1
323      0     2     2
324      1     1     1
325      0     0     0
326      1     9     9
327      0     4     4
328      0     0     0
329      0     4     4
330      1     7     7
331      1     1     1
332      0     4     4
333      1     5     5
334      0     6     6
335      0     8     8
336      0     6     6
337      0     4     4
338      1     3     3
339      1     9     9
340      1     7     7
341      1     3     3
342      1     7     7
343      1     3     3
344      0     6     6
345      1     7     7
346      1     7     7
347      1     7     7
348      0     0     0
349      1     3     3
350      0     2     2
351      1     7     7
352      0     0     0
353      1     7     7
354      0     2     2
355      0     8     8
356      0     2     2
357      1     5     5
358      0     6     6
359      0     6     6
360      1     5     5
361      1     3     3
362      1     7     7
363      1     3     3
364      0     6     6
365      0     8     8
366      0     4     4
367      1     7     7
368      1     7     7
369      1     3     3
370      0     6     6
371      0     8     8
372      0     8     8
373      0     6     6
374      0     2     2
375      1     9     9
376      1     5     5
377      1     5     5
378      0     2     2
379      1     5     5
380      1     9     9
381      1     3     3
382      1     5     5
383      0     8     8
384      1     7     7
385      1     5     5
386      0     8     8
387      1     7     7
388      1     5     5
389      1     7     7
390      1     7     7
391      0     0     0
392      0     8     8
393      0     8     8
394      1     9     9
395      0     0     0
396      1     5     5
397      1     5     5
398      0     4     4
399      1     9     9
400      0     2     2
401      0     2     2
402      1     9     9
403      1     3     3
404      0     4     4
405      0     4     4
406      0     8     8
407      1     1     1
408      0     2     2
409      1     3     3
410      1     9     9
411      1     3     3
412      0     4     4
413      1     1     1
414      1     9     9
415      0     4     4
416      0     0     0
417      0     2     2
418      1     9     9
419      0     8     8
420      1     1     1
421      0     2     2
422      1     3     3
423      0     0     0
424      1     3     3
425      0     6     6
426      0     4     4
427      0     2     2
428      1     7     7
429      1     3     3
430      1     7     7
431      0     0     0
432      1     5     5
433      0     0     0
434      1     7     7
435      0     6     6
436      0     8     8
437      0     6     6
438      1     7     7
439      0     8     8
440      1     3     3
441      1     3     3
442      0     4     4
443      1     1     1
444      0     4     4
445      0     2     2
446      0     6     6
447      0     6     6
448      0     6     6
449      0     6     6
450      1     1     1
451      0     4     4
452      1     7     7
453      1     3     3
454      1     3     3
455      1     5     5
456      1     1     1
457      0     8     8
458      1     5     5
459      0     4     4
460      0     6     6
461      1     9     9
462      1     5     5
463      0     0     0
464      0     0     0
465      1     1     1
466      0     0     0
467      0     8     8
468      1     9     9
469      1     9     9
470      0     0     0
471      0     2     2
472      0     4     4
473      0     2     2
474      0     0     0
475      1     9     9
476      0     6     6
477      1     7     7
478      1     7     7
479      0     2     2
480      0     2     2
481      0     2     2
482      0     4     4
483      0     6     6
484      0     8     8
485      1     1     1
486      0     8     8
487      0     2     2
488      0     0     0
489      1     5     5
490      1     9     9
491      1     5     5
492      1     5     5
493      1     3     3
494      0     8     8
495      0     4     4
496      1     3     3
497      1     1     1
498      0     2     2
499      0     8     8
500      1     7     7
501      0     0     0
502      1     1     1
503      0     8     8
504      1     1     1
505      0     0     0
506      1     5     5
507      1     3     3
508      0     8     8
509      0     0     0
510      0     0     0
511      1     5     5
512      0     4     4
513      0     2     2
514      0     4     4
515      1     3     3
516      1     9     9
517      0     8     8
518      0     6     6
519      1     1     1
520      1     9     9
521      1     3     3
522      1     1     1
523      0     6     6
524      0     6     6
525      1     1     1
526      1     3     3
527      1     1     1
528      0     4     4
529      1     5     5
530      1     7     7
531      0     0     0
532      0     6     6
533      1     5     5
534      1     7     7
535      1     9     9
536      0     4     4
537      1     7     7
538      0     8     8
539      0     6     6
540      0     6     6
541      1     3     3
542      0     6     6
543      1     7     7
544      0     6     6
545      0     4     4
546      1     3     3
547      0     4     4
548      0     4     4
549      0     0     0
550      0     4     4
551      1     9     9
552      0     8     8
553      0     4     4
554      0     0     0
555      0     8     8
556      1     3     3
557      0     6     6
558      1     5     5
559      0     2     2
560      0     6     6
561      0     8     8
562      0     8     8
563      1     9     9
564      0     8     8
565      0     0     0
566      0     4     4
567      0     2     2
568      0     2     2
569      0     0     0
570      0     2     2
571      0     0     0
572      0     8     8
573      1     1     1
574      1     3     3
575      1     7     7
576      1     1     1
577      0     4     4
578      1     3     3
579      0     2     2
580      1     1     1
581      0     4     4
582      0     0     0
583      0     0     0
584      0     0     0
585      0     2     2
586      0     8     8
587      1     1     1
588      1     5     5
589      0     0     0
590      0     4     4
591      0     2     2
592      1     5     5
593      0     0     0
594      1     1     1
595      0     4     4
596      0     6     6
597      0     0     0
598      1     3     3
599      1     7     7
600      1     7     7
601      0     6     6
602      0     8     8
603      0     4     4
604      1     7     7
605      0     6     6
606      1     9     9
607      0     6     6
608      1     1     1
609      1     7     7
610      0     0     0
611      0     8     8
612      1     9     9
613      1     1     1
614      0     4     4
615      1     9     9
616      1     9     9
617      1     1     1
618      0     2     2
619      1     7     7
620      0     2     2
621      1     5     5
622      1     5     5
623      0     0     0
624      1     1     1
625      0     2     2
626      0     0     0
627      0     8     8
628      1     1     1
629      0     4     4
630      1     5     5
631      0     8     8
632      1     7     7
633      1     9     9
634      0     2     2
635      1     3     3
636      1     1     1
637      1     9     9
638      0     0     0
639      0     6     6
640      0     8     8
641      1     7     7
642      0     2     2
643      0     4     4
644      1     9     9
645      0     6     6
646      0     2     2
647      1     5     5
648      0     6     6
649      1     1     1
650      1     3     3
651      0     0     0
652      0     4     4
653      1     1     1
654      0     6     6
655      1     3     3
656      1     5     5
657      0     4     4
658      0     8     8
659      1     9     9
660      1     5     5
661      0     8     8
662      0     8     8
663      1     7     7
664      1     1     1
665      1     5     5
666      1     5     5
667      0     2     2
668      0     0     0
669      0     2     2
670      0     2     2
671      1     1     1
672      0     6     6
673      1     3     3
674      0     0     0
675      1     1     1
676      1     5     5
677      1     7     7
678      0     8     8
679      0     4     4
680      0     2     2
681      1     9     9
682      1     3     3
683      1     7     7
684      1     3     3
685      0     4     4
686      1     7     7
687      0     8     8
688      1     1     1
689      0     6     6
690      0     8     8
691      0     0     0
692      1     1     1
693      0     4     4
694      1     9     9
695      0     0     0
696      1     5     5
697      1     7     7
698      0     6     6
699      1     1     1
700      1     1     1
701      1     7     7
702      0     0     0
703      0     0     0
704      1     3     3
705      0     8     8
706      1     7     7
707      0     8     8
708      0     8     8
709      0     4     4
710      0     8     8
711      1     7     7
712      1     7     7
713      0     2     2
714      0     0     0
715      1     3     3
716      1     7     7
717      0     2     2
718      0     4     4
719      0     0     0
720      1     5     5
721      1     1     1
722      1     1     1
723      0     8     8
724      1     9     9
725      0     7     8
726      0     6     6
727      1     1     1
728      0     0     0
729      0     4     4
730      1     9     9
731      1     9     9
732      0     0     0
733      1     9     9
734      0     8     8
735      0     2     2
736      0     8     8
737      1     7     7
738      1     1     1
739      1     9     9
740      0     4     4
741      0     6     6
742      1     7     7
743      1     7     7
744      0     6     6
745      1     1     1
746      1     5     5
747      0     2     2
748      1     7     7
749      0     6     6
750      0     2     2
751      1     9     9
752      1     9     9
753      1     9     9
754      0     2     2
755      1     1     1
756      0     0     0
757      1     9     9
758      0     0     0
759      1     9     9
760      1     7     7
761      1     3     3
762      1     7     7
763      1     7     7
764      1     9     9
765      0     6     6
766      0     4     4
767      0     2     2
768      0     2     2
769      1     1     1
770      1     5     5
771      0     4     4
772      0     0     0
773      0     4     4
774      0     6     6
775      0     2     2
776      1     7     7
777      1     9     9
778      1     5     5
779      1     1     1
780      1     1     1
781      1     5     5
782      1     5     5
783      1     1     1
784      0     0     0
785      0     6     6
786      0     2     2
787      1     9     9
788      0     6     6
789      0     2     2
790      0     8     8
791      0     0     0
792      0     2     2
793      1     5     5
794      1     1     1
795      1     3     3
796      1     7     7
797      0     2     2
798      1     5     5
799      0     8     8
800      1     3     3
801      1     9     9
802      0     6     6
803      0     8     8
804      0     6     6
805      0     6     6
806      1     5     5
807      1     1     1
808      0     6     6
809      0     8     8
810      0     6     6
811      1     1     1
812      0     0     0
813      1     3     3
814      0     6     6
815      0     4     4
816      0     6     6
817      1     5     5
818      0     6     6
819      1     5     5
820      0     0     0
821      1     1     1
822      0     8     8
823      1     7     7
824      1     7     7
825      0     0     0
826      1     5     5
827      1     5     5
828      1     7     7
829      0     6     6
830      1     9     9
831      1     3     3
832      0     0     0
833      0     4     4
834      1     7     7
835      0     2     2
836      0     0     0
837      1     3     3
838      1     5     5
839      1     9     9
840      0     6     6
841      0     6     6
842      1     5     5
843      0     4     4
844      1     3     3
845      1     1     1
846      0     6     6
847      1     3     3
848      1     3     3
849      1     1     1
850      0     2     2
851      1     7     7
852      0     4     4
853      1     5     5
854      0     8     8
855      0     8     8
856      0     2     2
857      1     3     3
858      1     7     7
859      1     5     5
860      1     5     5
861      0     8     8
862      1     5     5
863      1     9     9
864      0     6     6
865      1     9     9
866      1     3     3
867      1     3     3
868      1     5     5
869      1     3     3
870      0     0     0
871      1     9     9
872      1     3     3
873      0     0     0
874      0     8     8
875      1     1     1
876      0     6     6
877      0     8     8
878      1     3     3
879      1     9     9
880      0     4     4
881      0     6     6
882      0     6     6
883      0     2     2
884      0     0     0
885      0     4     4
886      1     9     9
887      0     0     0
888      0     6     6
889      1     5     5
890      1     5     5
891      1     7     7
892      0     8     8
893      1     3     3
894      1     3     3
895      1     3     3
896      1     5     5
897      1     1     1
898      1     5     5
899      0     2     2
900      0     4     4
901      1     7     7
902      0     0     0
903      0     6     6
904      0     6     6
905      0     2     2
906      0     4     4
907      1     5     5
908      1     3     3
909      0     6     6
910      1     7     7
911      1     3     3
912      1     1     1
913      1     9     9
914      1     5     5
915      1     1     1
916      1     5     5
917      0     8     8
918      0     0     0
919      0     8     8
920      1     7     7
921      0     8     8
922      1     3     3
923      0     0     0
924      1     5     5
925      0     6     6
926      1     3     3
927      0     2     2
928      0     0     0
929      0     0     0
930      1     1     1
931      0     6     6
932      1     3     3
933      0     6     6
934      0     8     8
935      0     0     0
936      0     4     4
937      0     8     8
938      1     3     3
939      1     3     3
940      1     1     1
941      1     3     3
942      0     4     4
943      1     9     9
944      0     0     0
945      1     7     7
946      0     8     8
947      0     8     8
948      1     7     7
949      1     3     3
950      1     1     1
951      0     2     2
952      0     8     8
953      0     0     0
954      1     7     7
955      0     0     0
956      1     1     1
957      0     0     0
958      1     1     1
959      0     8     8
960      1     1     1
961      0     0     0
962      1     5     5
963      1     1     1
964      0     4     4
965      0     4     4
966      0     6     6
967      1     9     9
968      1     1     1
969      0     4     4
970      1     5     5
971      1     1     1
972      1     5     5
973      1     3     3
974      1     1     1
975      1     1     1
976      0     8     8
977      1     5     5
978      1     9     9
979      0     2     2
980      0     0     0
981      0     8     8
982      0     4     4
983      1     3     3
984      1     3     3
985      0     6     6
986      0     6     6
987      0     0     0
988      0     6     6
989      0     4     4
990      1     5     5
991      1     3     3
992      1     3     3
993      1     7     7
994      0     8     8
995      1     7     7
996      0     6     6
997      1     9     9
998      0     2     2
999      1     7     7
1000     0     4     4
1001     1     9     9
1002     0     6     6
1003     0     8     8
1004     1     1     1
1005     0     0     0
1006     0     4     4
1007     0     0     0
1008     0     8     8
1009     0     0     0
1010     1     9     9
1011     1     7     7
1012     1     3     3
1013     1     9     9
1014     0     6     6
1015     0     2     2
1016     1     5     5
1017     0     8     8
1018     1     9     9
1019     0     2     2
1020     1     1     1
1021     0     8     8
1022     0     2     2
1023     1     1     1
1024     0     0     0
1025     1     9     9
1026     1     1     1
1027     0     6     6
1028     1     5     5
1029     0     8     8
1030     0     4     4
1031     1     9     9
1032     0     0     0
1033     0     6     6
1034     1     5     5
1035     0     4     4
1036     1     5     5
1037     0     8     8
1038     0     6     6
1039     0     8     8
1040     1     9     9
1041     0     0     0
1042     1     1     1
1043     1     1     1
1044     1     7     7
1045     0     0     0
1046     1     1     1
1047     0     2     2
1048     0     8     8
1049     1     5     5
1050     1     9     9
1051     0     4     4
1052     1     5     5
1053     0     4     4
1054     1     3     3
1055     1     3     3
1056     0     8     8
1057     0     6     6
1058     0     0     0
1059     0     6     6
1060     0     6     6
1061     0     6     6
1062     0     0     0
1063     1     9     9
1064     0     6     6
1065     0     8     8
1066     1     1     1
1067     0     4     4
1068     0     4     4
1069     0     0     0
1070     0     2     2
1071     1     1     1
1072     1     7     7
1073     0     6     6
1074     1     1     1
1075     0     6     6
1076     1     9     9
1077     0     4     4
1078     0     4     4
1079     1     7     7
1080     0     0     0
1081     1     7     7
1082     1     3     3
1083     1     5     5
1084     0     0     0
1085     0     4     4
1086     0     6     6
1087     0     8     8
1088     1     3     3
1089     0     6     6
1090     0     6     6
1091     1     9     9
1092     0     4     4
1093     0     4     4
1094     1     3     3
1095     0     2     2
1096     1     5     5
1097     0     4     4
1098     0     4     4
1099     0     8     8
1100     0     8     8
1101     1     5     5
1102     1     5     5
1103     1     5     5
1104     0     4     4
1105     1     7     7
1106     1     9     9
1107     1     7     7
1108     0     4     4
1109     0     8     8
1110     1     9     9
1111     1     3     3
1112     0     4     4
1113     0     6     6
1114     1     1     1
1115     0     0     0
1116     1     7     7
1117     0     4     4
1118     0     4     4
1119     1     3     3
1120     0     8     8
1121     0     2     2
1122     1     1     1
1123     1     3     3
1124     0     4     4
1125     1     7     7
1126     0     2     2
1127     1     3     3
1128     1     5     5
1129     0     2     2
1130     0     2     2
1131     0     4     4
1132     0     2     2
1133     0     0     0
1134     0     6     6
1135     0     6     6
1136     0     0     0
1137     0     8     8
1138     1     5     5
1139     1     7     7
1140     0     0     0
1141     1     1     1
1142     0     2     2
1143     1     3     3
1144     0     2     2
1145     1     7     7
1146     1     1     1
1147     0     0     0
1148     0     0     0
1149     1     7     7
1150     0     8     8
1151     1     1     1
1152     1     3     3
1153     0     2     2
1154     0     8     8
1155     1     9     9
1156     0     0     0
1157     0     8     8
1158     0     8     8
1159     0     8     8
1160     0     4     4
1161     1     1     1
1162     1     3     3
1163     0     0     0
1164     1     9     9
1165     0     2     2
1166     1     3     3
1167     1     7     7
1168     0     0     0
1169     0     2     2
1170     1     9     9
1171     0     4     4
1172     1     7     7
1173     1     7     7
1174     0     4     4
1175     0     8     8
1176     1     1     1
1177     0     6     6
1178     0     2     2
1179     0     2     2
1180     1     5     5
1181     0     6     6
1182     1     3     3
1183     1     7     7
1184     0     6     6
1185     1     5     5
1186     0     8     8
1187     1     5     5
1188     1     3     3
1189     0     6     6
1190     0     8     8
1191     1     9     9
1192     0     0     0
1193     0     8     8
1194     0     6     6
1195     0     4     4
1196     1     3     3
1197     1     9     9
1198     1     9     9
1199     1     5     5
1200     0     4     4
1201     1     7     7
1202     1     5     5
1203     0     8     8
1204     0     6     6
1205     0     2     2
1206     1     1     1
1207     0     4     4
1208     1     9     9
1209     0     8     8
1210     0     6     6
1211     0     2     2
1212     1     5     5
1213     1     1     1
1214     0     2     2
1215     0     2     2
1216     1     5     5
1217     1     3     3
1218     0     6     6
1219     0     6     6
1220     0     2     2
1221     1     5     5
1222     1     1     1
1223     1     5     5
1224     1     5     5
1225     1     5     5
1226     1     7     7
1227     1     1     1
1228     0     2     2
1229     1     1     1
1230     1     1     1
1231     1     1     1
1232     1     7     7
1233     0     2     2
1234     0     2     2
1235     0     8     8
1236     1     9     9
1237     1     3     3
1238     1     7     7
1239     0     8     8
1240     1     3     3
1241     1     9     9
1242     1     5     5
1243     1     3     3
1244     1     3     3
1245     1     5     5
1246     1     7     7
1247     1     3     3
1248     1     9     9
1249     1     9     9
1250     0     6     6
1251     0     0     0
1252     0     6     6
1253     0     4     4
1254     1     3     3
1255     1     3     3
1256     0     4     4
1257     1     3     3
1258     0     4     4
1259     0     2     2
1260     1     3     3
1261     0     2     2
1262     1     9     9
1263     1     9     9
1264     0     8     8
1265     0     8     8
1266     0     2     2
1267     0     4     4
1268     0     8     8
1269     1     3     3
1270     0     6     6
1271     1     5     5
1272     0     8     8
1273     0     0     0
1274     1     7     7
1275     1     1     1
1276     1     3     3
1277     0     2     2
1278     1     1     1
1279     0     0     0
1280     1     7     7
1281     1     1     1
1282     1     5     5
1283     0     4     4
1284     0     6     6
1285     0     6     6
1286     1     5     5
1287     0     4     4
1288     1     3     3
1289     0     8     8
1290     1     9     9
1291     1     5     5
1292     1     3     3
1293     0     4     4
1294     0     0     0
1295     0     0     0
1296     0     2     2
1297     1     9     9
1298     0     8     8
1299     0     6     6
1300     0     2     2
1301     0     8     8
1302     0     4     4
1303     0     0     0
1304     1     1     1
1305     1     5     5
1306     1     3     3
1307     0     6     6
1308     0     2     2
1309     1     5     5
1310     1     5     5
1311     1     7     7
1312     0     4     4
1313     0     8     8
1314     0     2     2
1315     1     9     9
1316     0     8     8
1317     1     5     5
1318     0     2     2
1319     0     4     4
1320     0     6     6
1321     1     3     3
1322     0     2     2
1323     0     2     2
1324     1     5     5
1325     1     3     3
1326     0     2     2
1327     1     9     9
1328     1     9     9
1329     1     9     9
1330     1     7     7
1331     0     2     2
1332     0     8     8
1333     1     7     7
1334     0     2     2
1335     0     4     4
1336     0     4     4
1337     1     9     9
1338     1     7     7
1339     1     9     9
1340     0     8     8
1341     0     4     4
1342     0     6     6
1343     0     6     6
1344     1     3     3
1345     1     9     9
1346     1     3     3
1347     0     8     8
1348     1     9     9
1349     0     8     8
1350     0     6     6
1351     1     9     9
1352     1     5     5
1353     0     6     6
1354     0     6     6
1355     1     1     1
1356     0     6     6
1357     1     7     7
1358     1     9     9
1359     1     7     7
1360     1     9     9
1361     0     8     8
1362     0     0     0
1363     1     7     7
1364     0     0     0
1365     1     7     7
1366     1     3     3
1367     0     6     6
1368     1     7     7
1369     1     3     3
1370     0     0     0
1371     1     7     7
1372     0     2     2
1373     0     8     8
1374     0     0     0
1375     0     4     4
1376     1     1     1
1377     1     1     1
1378     0     2     2
1379     0     4     4
1380     1     5     5
1381     1     5     5
1382     0     0     0
1383     1     9     9
1384     0     0     0
1385     1     5     5
1386     1     3     3
1387     0     2     2
1388     0     4     4
1389     1     3     3
1390     0     0     0
1391     0     8     8
1392     0     2     2
1393     0     8     8
1394     1     3     3
1395     1     3     3
1396     0     8     8
1397     0     4     4
1398     0     4     4
1399     1     5     5
1400     1     5     5
1401     1     1     1
1402     0     8     8
1403     0     8     8
1404     1     3     3
1405     0     0     0
1406     0     0     0
1407     1     9     9
1408     0     4     4
1409     0     4     4
1410     0     4     4
1411     0     0     0
1412     1     9     9
1413     0     4     4
1414     0     8     8
1415     0     6     6
1416     0     2     2
1417     1     7     7
1418     1     9     9
1419     0     4     4
1420     1     9     9
1421     0     6     6
1422     1     3     3
1423     0     6     6
1424     0     2     2
1425     0     2     2
1426     1     5     5
1427     1     1     1
1428     0     8     8
1429     0     4     4
1430     0     8     8
1431     1     3     3
1432     0     6     6
1433     0     4     4
1434     0     6     6
1435     1     1     1
1436     0     4     4
1437     0     5     4
1438     1     7     7
1439     1     3     3
1440     1     7     7
1441     0     4     4
1442     1     1     1
1443     0     2     2
1444     1     9     9
1445     1     1     1
1446     0     6     6
1447     0     6     6
1448     0     4     4
1449     0     4     4
1450     1     3     3
1451     1     5     5
1452     1     3     3
1453     1     5     5
1454     0     6     6
1455     1     3     3
1456     0     6     6
1457     0     0     0
1458     0     4     4
1459     1     1     1
1460     0     2     2
1461     1     9     9
1462     1     5     5
1463     1     5     5
1464     1     5     5
1465     1     7     7
1466     0     4     4
1467     0     8     8
1468     1     9     9
1469     0     2     2
1470     1     3     3
1471     0     0     0
1472     0     4     4
1473     0     8     8
1474     1     1     1
1475     0     4     4
1476     0     8     8
1477     0     4     4
1478     1     7     7
1479     0     4     4
1480     1     3     3
1481     1     9     9
1482     1     5     5
1483     1     1     1
1484     0     8     8
1485     1     3     3
1486     0     4     4
1487     0     0     0
1488     0     0     0
1489     1     3     3
1490     0     2     2
1491     0     8     8
1492     1     1     1
1493     1     5     5
1494     0     8     8
1495     1     3     3
1496     0     0     0
1497     1     7     7
1498     0     6     6
1499     0     6     6
1500     1     3     3
1501     1     1     1
1502     1     1     1
1503     1     9     9
1504     0     0     0
1505     1     9     9
1506     0     0     0
1507     0     2     2
1508     1     1     1
1509     1     3     3
1510     0     8     8
1511     0     6     6
1512     0     8     8
1513     0     4     4
1514     1     5     5
1515     0     4     4
1516     1     1     1
1517     1     9     9
1518     0     8     8
1519     1     7     7
1520     1     1     1
1521     1     1     1
1522     0     2     2
1523     0     6     6
1524     1     7     7
1525     0     2     2
1526     1     5     5
1527     0     8     8
1528     0     8     8
1529     0     2     2
1530     0     4     4
1531     1     3     3
1532     0     8     8
1533     0     8     8
1534     0     0     0
1535     1     1     1
1536     0     4     4
1537     0     6     6
1538     1     9     9
1539     0     2     2
1540     0     0     0
1541     1     3     3
1542     1     7     7
1543     0     6     6
1544     0     2     2
1545     1     1     1
1546     0     2     2
1547     1     3     3
1548     1     9     9
1549     0     8     8
1550     0     8     8
1551     1     1     1
1552     1     9     9
1553     0     4     4
1554     0     6     6
1555     1     7     7
1556     1     3     3
1557     1     7     7
1558     1     1     1
1559     0     4     4
1560     0     0     0
1561     1     5     5
1562     1     5     5
1563     1     5     5
1564     0     2     2
1565     1     7     7
1566     1     7     7
1567     0     4     4
1568     0     8     8
1569     1     5     5
1570     1     7     7
1571     1     7     7
1572     0     0     0
1573     0     4     4
1574     1     7     7
1575     0     8     8
1576     0     6     6
1577     1     1     1
1578     0     6     6
1579     0     2     2
1580     0     0     0
1581     0     6     6
1582     1     1     1
1583     1     7     7
1584     1     1     1
1585     1     1     1
1586     1     7     7
1587     0     4     4
1588     1     1     1
1589     0     8     8
1590     0     0     0
1591     0     2     2
1592     0     0     0
1593     0     0     0
1594     0     6     6
1595     0     6     6
1596     1     5     5
1597     1     3     3
1598     0     8     8
1599     1     3     3
1600     1     7     7
1601     1     9     9
1602     1     7     7
1603     0     6     6
1604     1     1     1
1605     1     3     3
1606     0     4     4
1607     1     7     7
1608     0     4     4
1609     0     6     6
1610     1     1     1
1611     1     7     7
1612     0     8     8
1613     1     3     3
1614     1     1     1
1615     0     2     2
1616     1     3     3
1617     1     7     7
1618     0     0     0
1619     0     8     8
1620     1     9     9
1621     0     0     0
1622     1     9     9
1623     0     8     8
1624     0     8     8
1625     0     8     8
1626     0     4     4
1627     0     2     2
1628     0     0     0
1629     1     3     3
1630     0     2     2
1631     1     5     5
1632     1     3     3
1633     0     2     2
1634     0     6     6
1635     0     6     6
1636     1     7     7
1637     1     5     5
1638     1     5     5
1639     1     5     5
1640     1     1     1
1641     1     7     7
1642     0     6     6
1643     1     3     3
1644     1     5     5
1645     0     2     2
1646     1     3     3
1647     1     5     5
1648     1     3     3
1649     0     4     4
1650     0     2     2
1651     0     6     6
1652     1     7     7
1653     0     8     8
1654     0     6     6
1655     0     0     0
1656     1     3     3
1657     1     7     7
1658     0     2     2
1659     0     2     2
1660     1     5     5
1661     0     4     4
1662     1     1     1
1663     0     4     4
1664     1     7     7
1665     1     5     5
1666     0     0     0
1667     0     8     8
1668     1     5     5
1669     1     1     1
1670     1     9     9
1671     1     7     7
1672     1     7     7
1673     1     1     1
1674     0     0     0
1675     0     8     8
1676     1     1     1
1677     0     8     8
1678     1     1     1
1679     0     0     0
1680     1     3     3
1681     1     7     7
1682     1     5     5
1683     0     2     2
1684     0     6     6
1685     0     0     0
1686     0     4     4
1687     0     4     4
1688     1     1     1
1689     1     5     5
1690     0     0     0
1691     1     7     7
1692     0     4     4
1693     1     9     9
1694     0     6     6
1695     0     8     8
1696     0     6     6
1697     1     5     5
1698     0     2     2
1699     1     3     3
1700     1     7     7
1701     0     8     8
1702     1     9     9
1703     1     1     1
1704     0     4     4
1705     0     6     6
1706     0     2     2
1707     0     6     6
1708     0     8     8
1709     1     5     5
1710     0     4     4
1711     1     3     3
1712     0     8     8
1713     1     5     5
1714     1     7     7
1715     1     1     1
1716     1     7     7
1717     0     8     8
1718     1     1     1
1719     0     8     8
1720     1     3     3
1721     1     3     3
1722     0     6     6
1723     0     0     0
1724     0     6     6
1725     0     6     6
1726     1     3     3
1727     0     4     4
1728     1     1     1
1729     1     5     5
1730     0     0     0
1731     0     6     6
1732     1     5     5
1733     1     1     1
1734     1     3     3
1735     1     3     3
1736     1     3     3
1737     1     5     5
1738     1     1     1
1739     1     9     9
1740     1     5     5
1741     0     0     0
1742     0     8     8
1743     0     4     4
1744     0     6     6
1745     1     3     3
1746     1     3     3
1747     0     4     4
1748     0     4     4
1749     0     0     0
1750     0     8     8
1751     1     7     7
1752     0     0     0
1753     0     6     6
1754     1     5     5
1755     0     6     6
1756     0     6     6
1757     0     0     0
1758     0     6     6
1759     1     7     7
1760     1     7     7
1761     0     6     6
1762     1     7     7
1763     0     6     6
1764     1     7     7
1765     0     6     6
1766     0     4     4
1767     0     2     2
1768     1     9     9
1769     0     0     0
1770     0     8     8
1771     0     2     2
1772     0     6     6
1773     0     0     0
1774     1     3     3
1775     1     3     3
1776     1     9     9
1777     0     4     4
1778     1     1     1
1779     0     0     0
1780     0     2     2
1781     1     5     5
1782     0     0     0
1783     1     3     3
1784     1     1     1
1785     1     3     3
1786     0     2     2
1787     1     9     9
1788     1     7     7
1789     0     0     0
1790     1     7     7
1791     0     8     8
1792     0     8     8
1793     0     8     8
1794     1     1     1
1795     0     4     4
1796     1     5     5
1797     1     3     3
1798     0     0     0
1799     1     5     5
1800     0     4     4
1801     0     0     0
1802     0     4     4
1803     0     0     0
1804     0     6     6
1805     1     5     5
1806     0     8     8
1807     0     2     2
1808     1     1     1
1809     0     0     0
1810     1     9     9
1811     0     4     4
1812     1     3     3
1813     0     8     8
1814     0     0     0
1815     1     9     9
1816     1     3     3
1817     0     0     0
1818     1     5     5
1819     0     8     8
1820     0     0     0
1821     1     5     5
1822     1     1     1
1823     0     6     6
1824     0     4     4
1825     1     7     7
1826     0     8     8
1827     0     8     8
1828     1     5     5
1829     0     2     2
1830     0     2     2
1831     0     4     4
1832     1     9     9
1833     1     3     3
1834     1     7     7
1835     0     8     8
1836     0     2     2
1837     0     2     2
1838     1     3     3
1839     1     7     7
1840     0     8     8
1841     0     6     6
1842     1     1     1
1843     0     2     2
1844     0     2     2
1845     0     6     6
1846     0     0     0
1847     0     4     4
1848     1     3     3
1849     0     4     4
1850     0     2     2
1851     0     4     4
1852     1     7     7
1853     1     5     5
1854     0     0     0
1855     1     7     7
1856     0     0     0
1857     0     6     6
1858     1     3     3
1859     1     5     5
1860     1     7     7
1861     1     9     9
1862     1     9     9
1863     0     6     6
1864     1     3     3
1865     1     9     9
1866     1     5     5
1867     1     5     5
1868     1     1     1
1869     0     6     6
1870     0     6     6
1871     1     1     1
1872     0     8     8
1873     1     3     3
1874     0     0     0
1875     1     3     3
1876     0     2     2
1877     1     7     7
1878     1     5     5
1879     0     8     8
1880     0     6     6
1881     1     3     3
1882     0     6     6
1883     0     0     0
1884     0     0     0
1885     1     5     5
1886     1     7     7
1887     1     3     3
1888     1     7     7
1889     1     3     3
1890     0     8     8
1891     0     0     0
1892     0     4     4
1893     1     7     7
1894     1     3     3
1895     0     0     0
1896     0     6     6
1897     1     7     7
1898     1     1     1
1899     0     2     2
1900     1     1     1
1901     1     9     9
1902     0     8     8
1903     1     1     1
1904     0     8     8
1905     1     7     7
1906     1     5     5
1907     0     6     6
1908     0     4     4
1909     0     4     4
1910     1     7     7
1911     0     2     2
1912     0     8     8
1913     0     8     8
1914     1     3     3
1915     1     5     5
1916     0     8     8
1917     0     2     2
1918     1     7     7
1919     0     8     8
1920     0     8     8
1921     1     3     3
1922     1     9     9
1923     1     9     9
1924     0     2     2
1925     0     0     0
1926     1     1     1
1927     0     8     8
1928     1     9     9
1929     0     6     6
1930     0     8     8
1931     1     5     5
1932     1     5     5
1933     0     2     2
1934     1     1     1
1935     0     6     6
1936     1     7     7
1937     0     0     0
1938     1     7     7
1939     0     8     8
1940     1     9     9
1941     1     1     1
1942     1     9     9
1943     0     6     6
1944     0     0     0
1945     0     0     0
1946     1     3     3
1947     0     8     8
1948     1     1     1
1949     1     9     9
1950     0     8     8
1951     0     2     2
1952     0     6     6
1953     0     0     0
1954     1     3     3
1955     0     6     6
1956     0     2     2
1957     1     3     3
1958     0     8     8
1959     0     6     6
1960     0     0     0
1961     0     4     4
1962     0     0     0
1963     0     8     8
1964     0     0     0
1965     1     9     9
1966     0     0     0
1967     0     6     6
1968     0     8     8
1969     1     3     3
1970     0     6     6
1971     1     3     3
1972     0     6     6
1973     0     2     2
1974     0     2     2
1975     0     2     2
1976     0     0     0
1977     1     9     9
1978     0     0     0
1979     1     1     1
1980     1     1     1
1981     1     1     1
1982     1     9     9
1983     0     8     8
1984     1     5     5
1985     0     6     6
1986     0     2     2
1987     0     0     0
1988     1     1     1
1989     0     4     4
1990     0     4     4
1991     1     1     1
1992     0     6     6
1993     0     2     2
1994     1     1     1
1995     0     6     6
1996     0     6     6
1997     1     3     3
1998     1     9     9
1999     0     4     4"""[1:]
